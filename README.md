Бэкенд-сервер для системы лояльности кафе, позволяющий клиентам накапливать и использовать бонусные баллы.


Содержание

-Требования
-Пошаговая инструкция по установке
-Структура API
-Тестирование API
-Устранение неполадок

Требования

Для запуска проекта вам потребуется:

Node.js (версия 18 или выше)
MySQL (версия 5.7 или выше)
npm (обычно устанавливается вместе с Node.js)

Пошаговая инструкция по установке

Шаг 1: Подготовка рабочей среды

1.1. Установка Node.js (если еще не установлен)

Перейдите на сайт nodejs.org
Скачайте и установите LTS (Long Term Support) версию для вашей операционной системы
Проверьте установку, открыв командную строку (терминал) и введя:
node -v
npm -v

Вы должны увидеть версии Node.js и npm

1.2. Установка MySQL (если еще не установлен)

Скачайте и установите MySQL с официального сайта
Во время установки создайте пароль для пользователя root
Рекомендуется также установить MySQL Workbench (графический интерфейс для работы с MySQL) с того же сайта

Шаг 2: Установка проекта

2.1. Распаковка проекта

Распакуйте полученную папку с проектом в удобное место на вашем компьютере, если еще не распаковали

2.2. Установка зависимостей

Откройте командную строку (терминал)
Перейдите в папку проекта:
cd путь/к/папке/cafe-loyalty-system
Установите зависимости:
npm install
Это установит все необходимые библиотеки, указанные в файле package.json

Шаг 3: Настройка базы данных

3.1. Создание базы данных

Вариант 1: Через MySQL Workbench


Откройте MySQL Workbench

Подключитесь к вашему локальному серверу MySQL (обычно localhost:3306)

Создайте новую базу данных:
Нажмите на иконку SQL (выглядит как лист с молнией)
Введите: CREATE DATABASE cafe_loyalty;
Нажмите на иконку молнии для выполнения

Импортируйте структуру таблиц:
В том же окне SQL выберите File > Open SQL Script
Найдите и откройте файл schema.sql из папки проекта
Нажмите на иконку молнии для выполнения скрипта

Вариант 2: Через командную строку


Откройте командную строку (терминал)
Войдите в MySQL:
mysql -u root -p
Введите ваш пароль, когда будет предложено
Создайте базу данных:
CREATE DATABASE cafe_loyalty;
EXIT;

Импортируйте структуру таблиц:
mysql -u root -p cafe_loyalty < путь/к/папке/cafe-loyalty-system/schema.sql
Введите ваш пароль, когда будет предложено

Шаг 4: Настройка переменных окружения

В папке проекта найдите файл .env.example
Создайте копию этого файла и назовите её .env (просто .env без расширения)
Откройте файл .env в любом текстовом редакторе
Обновите значения:
PORT=3000
JWT_SECRET=ваш_секретный_ключ_для_jwt  # Придумайте любую сложную строку

DB_HOST=localhost
DB_USER=root  # Или ваше имя пользователя MySQL
DB_PASSWORD=ваш_пароль_mysql  # Пароль, который вы установили при установке MySQL
DB_NAME=cafe_loyalty

Сохраните файл

Шаг 5: Запуск сервера

Откройте командную строку (терминал)
Перейдите в папку проекта:
cd путь/к/папке/cafe-loyalty-system
Запустите сервер:
npm start
Вы должны увидеть сообщения:
Database connected successfully
Server running on port 3000

Сервер теперь запущен и доступен по адресу http://localhost:3000

Для остановки сервера нажмите Ctrl+C в командной строке.


Структура API

Аутентификация

Регистрация пользователя

POST /api/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123",
  "name": "John Doe"
}


Авторизация

POST /api/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}


Ответ содержит JWT-токен, который нужно использовать для авторизованных запросов.


Управление баллами

Все запросы требуют заголовок авторизации:


Authorization: Bearer ваш_jwt_токен

Начисление баллов

POST /api/points
Content-Type: application/json

{
  "amount": 100,
  "type": "add"
}


Списание баллов

POST /api/points
Content-Type: application/json

{
  "amount": 50,
  "type": "subtract"
}


Проверка баланса

GET /api/balance

История операций

GET /api/history

Дополнительные параметры:


GET /api/history?limit=10&offset=0

Тестирование API

Установка Postman (рекомендуется для тестирования)

Скачайте и установите Postman
Запустите Postman

Тестирование регистрации

Создайте новый запрос:
Метод: POST
URL: http://localhost:3000/api/register
Во вкладке "Body":
Выберите "raw"
Выберите "JSON" из выпадающего списка
Введите:
{
  "email": "user@example.com",
  "password": "password123",
  "name": "John Doe"
}

Нажмите кнопку "Send"
Вы должны получить ответ с кодом 201 и сообщением об успешной регистрации

Тестирование авторизации

Создайте новый запрос:
Метод: POST
URL: http://localhost:3000/api/login
Во вкладке "Body":
Выберите "raw"
Выберите "JSON" из выпадающего списка
Введите:
{
  "email": "user@example.com",
  "password": "password123"
}

Нажмите кнопку "Send"
Вы должны получить ответ с токеном JWT
Важно: Скопируйте значение поля "token" из ответа - оно понадобится для следующих запросов

Тестирование начисления баллов

Создайте новый запрос:
Метод: POST
URL: http://localhost:3000/api/points
Во вкладке "Authorization":
Выберите тип "Bearer Token"
Вставьте скопированный ранее токен в поле "Token"
Во вкладке "Body":
Выберите "raw"
Выберите "JSON" из выпадающего списка
Введите:
{
  "amount": 100,
  "type": "add"
}

Нажмите кнопку "Send"
Вы должны получить ответ с новым балансом

Тестирование проверки баланса

Создайте новый запрос:
Метод: GET
URL: http://localhost:3000/api/balance
Во вкладке "Authorization":
Выберите тип "Bearer Token"
Вставьте скопированный ранее токен в поле "Token"
Нажмите кнопку "Send"
Вы должны получить ответ с текущим балансом

Устранение неполадок

Проблемы с подключением к базе данных

Если вы видите ошибки подключения к базе данных:


Проверьте, запущен ли MySQL сервер
В Windows: Проверьте службу MySQL в Диспетчере задач
В macOS: Проверьте через Системные настройки
В Linux: sudo systemctl status mysql
Проверьте правильность данных в файле .env
Имя пользователя и пароль должны совпадать с теми, что вы используете для MySQL
Убедитесь, что база данных cafe_loyalty существует:
mysql -u root -p -e "SHOW DATABASES;"
Проверьте, что таблицы созданы:
mysql -u root -p -e "USE cafe_loyalty; SHOW TABLES;"

Проблемы с запуском сервера

Если сервер не запускается:


Проверьте, что все зависимости установлены:
npm install
Проверьте, что порт 3000 не занят другим приложением:
Попробуйте изменить порт в файле .env на другой (например, 3001)
Проверьте логи ошибок в консоли

Проблемы с API запросами

Если API запросы не работают:


Проверьте, что сервер запущен и работает
Убедитесь, что вы используете правильный URL и метод запроса
Для защищенных маршрутов проверьте, что:
Токен не истек (JWT-токены действительны 24 часа)
Токен правильно добавлен в заголовок Authorization
Проверьте формат отправляемых данных (должен быть валидный JSON)
